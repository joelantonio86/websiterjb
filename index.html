<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Racional Jazz Band - M√∫sica, Arte e Cultura</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

   <script>
        // --- Configura√ß√£o Tailwind ---
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'rjb-yellow': '#FFD700',
                        'rjb-text': '#2A2A2A',
                        'rjb-bg-light': '#F8F9FA',
                        'rjb-card-light': '#FFFFFF',
                        'rjb-bg-dark': '#121212',
                        'rjb-card-dark': '#1E1E1E',
                        'rjb-text-dark': '#E0E0E0',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas'],
                    },
                    boxShadow: {
                        'soft-glow': '0 0 20px rgba(255, 215, 0, 0.6)',
                        'subtle-glow': '0 0 10px rgba(255, 215, 0, 0.2)',
                        'deep-shadow': '0 10px 30px rgba(0, 0, 0, 0.1)',
                    },
                }
            }
        }

        // --- DADOS E VARI√ÅVEIS GLOBAIS ---
        let currentPage = 'home';
        let currentAudio = null;
        let playingButton = null;

        const subMenuRJB = {
            'apresentacoes': 'Apresenta√ß√µes / Nossas apresenta√ß√µes ',
            'bastidores': 'Ensaios / Pessoas de diversos estados ',
            'repertorio': 'Repert√≥rio/ M√∫sicas originais',
            'partituras': 'Partituras / √Årea Exclusiva para M√∫sicos',
            'fotos': 'Fotos / Fotos de apresenta√ß√µes',
        };

        // Dados de V√≠deo Centralizados (MANTIDOS)
        const APRESENTACOES_VIDEOS = [
            { title: 'Canto das tr√™s Ra√ßas - Retiro Racional', date: '04/OUT/2025', id: '9n4l2zXi_yE' },
            { title: 'Oxig√™nio - Retiro Racional', date: '04/NOV/2017', id: 'U5vlHEpb82Q' },
            { title: 'Do seu lado - Retiro Racional', date: '04/OUT/2025', id: 'ZWNoul_SB0c' },
        ];

        const BASTIDORES_VIDEOS = [
            { title: 'O Dever de Fazer Propaganda Deste Conhecimento', date: '04/OUT/2025', id: 'aCdnUJeLzRQ' },
            { title: 'Whisky √† go-go', date: '15/DEZ/2025', id: 'Cnj23NucMnY' },
            { title: 'Titanium', date: '04/OUT/2025', id: '73XEtc64fdw' },
            { title: 'Titanium - Guitarra', date: '04/OUT/2025', id: 'pXIKPmZB0IM' },
            { title: 'Trompeta da Espanha', date: '04/OUT/2025', id: 'RF7dOiaO5cw' },
            { title: 'Anuncia√ß√£o - Guitarra', date: '04/OUT/2025', id: 'THH7BrWbC6o' },
        ];
        // index.html: DADOS E VARI√ÅVEIS GLOBAIS
        // Substitua o placeholder pela URL p√∫blica do seu bucket R2
        const R2_BASE_URL = 'https://pub-934c96bc6fb449a7ad7b3491065976d3.r2.dev';
        // OU, se voc√™ usa dom√≠nio pr√≥prio:
        // const R2_BASE_URL = 'https://files.rjb.com.br/sheets';
        const racionais = [
            { title: 'A Consci√™ncia Positiva', time: '3:00', mp3: 'A_Consciencia_Positiva' },
            { title: 'A Luz do Saber', time: '3:00', mp3: 'A_Luz_Do_Saber' },
            { title: 'A Luz que Mudou o Meu Destino', time: '3:00', mp3: 'A_Luz_Que_Mudou_O_Meu_Destino' },
            { title: 'Apoteose Racional', time: '3:00', mp3: 'Apoteose_Racional' },
            //{ title: 'De Onde Veio e Vai', time: '3:00', mp3: 'De_Onde_Veio_e_Vai' },
            { title: 'Deixa Quem Quiser Falar', time: '3:00', mp3: 'Deixa_Quem_Quiser_Falar' },
            { title: 'Desencanto Universal', time: '3:00', mp3: 'Desencanto_Universal' },
            { title: 'Homenagem a Brud', time: '3:00', mp3: 'Homenagem_A_Brud' },
            { title: 'Jubileu de Ouro', time: '3:00', mp3: 'Jubileu_De_Ouro' },
            { title: 'Menino Rei', time: '3:00', mp3: 'Menino_Rei' },
            { title: 'Meu Lugar N√£o √© Aqui', time: '3:00', mp3: 'Meu_Lugar_Nao_E_Aqui' },
            { title: 'Mundo Racional', time: '3:00', mp3: 'Mundo_Racional' },
            { title: 'Natureza', time: '3:00', mp3: 'Natureza' },
            { title: 'O Homem', time: '3:00', mp3: 'O_Homem' },
            //{ title: 'Os Caravaneiros - Em Andamento', time: '3:00', mp3: 'Os_Caravaneiros_Em_Andamento' },
            { title: 'Oxig√™nio - Rosa', time: '3:00', mp3: 'Oxigenio' },
            { title: 'Oxig√™nio da Vida - Alisson', time: '3:00', mp3: 'Oxigenio_Da_Vida' },
            { title: 'Para√≠so Racional', time: '3:00', mp3: 'Paraiso_Racional' },
            { title: 'Paz Interior', time: '3:00', mp3: 'Paz_Interior' },
            { title: 'Salve o Retiro Racional', time: '3:00', mp3: 'Salve_O_Retiro_Racional' },
            { title: 'Ser Iluminado', time: '3:00', mp3: 'Ser_Iluminado' },
            //{ title: 'Viva a Cultura Racional', time: '3:00', mp3: 'Viva_A_Cultura_Racional' },
        ];

const diversas = [
  { title: 'Ai Que Saudade Do C√™', time: '3:00', mp3: 'Ai_Que_Saudade_Doce' },
  { title: 'Anuncia√ß√£o', time: '4:10', mp3: 'Anunciacao' },
  { title: '√Åria Cantinela', time: '3:20', mp3: 'Aria_Cantinela' },
  { title: 'As For√ßas da Natureza', time: '4:55', mp3: 'As_Forcas_Da_Natureza' },
  { title: 'Billie Jean', time: '4:50', mp3: 'Billie_Jean' },
  { title: 'Caruso', time: '4:20', mp3: 'Caruso' },
  { title: 'Cheia de Manias', time: '3:50', mp3: 'Cheia_De_Manias' },
  { title: 'Colo de Menina', time: '3:55', mp3: 'Colo_De_Menina' },
  { title: 'Con te Partir√≥', time: '4:40', mp3: 'Conte_Te_Partiro' },
  { title: 'Daqui Pra Sempre', time: '3:15', mp3: 'Daqui_Pra_Sempre' },
  { title: 'Do Seu Lado', time: '3:35', mp3: 'Do_Seu_Lado' },
  { title: 'Eu S√≥ Quero Um Xod√≥', time: '3:05', mp3: 'Eu_So_Quero_Um_Xodo' },
  { title: 'Felicidade', time: '3:25', mp3: 'Felicidade' },
  { title: 'Fulminante', time: '4:35', mp3: 'Fulminante' },
  { title: 'Game of Thrones', time: '3:40', mp3: 'Game_Of_Thrones' },
  { title: 'Girls Just Want to Have Fun', time: '4:00', mp3: 'Girls_Just_Want_To_Have_Fun' },
  { title: 'Heal the World', time: '5:00', mp3: 'Heal_The_World' },
  { title: 'Menina Carolina', time: '3:10', mp3: 'Menina_Carolina' },
  { title: 'Naquela Mesa', time: '3:58', mp3: 'Naquela_Mesa' },
  { title: 'Olhos Coloridos', time: '3:40', mp3: 'Olhos_Coloridos' },
  { title: 'Ouro Negro', time: '3:55', mp3: 'Ouro_Negro' },
  { title: 'O Canto das Tr√™s Ra√ßas', time: '4:25', mp3: 'O_Canto_Das_Tres_Racas' },
  { title: 'O Homem - Roberto Carlos', time: '4:15', mp3: 'O_Homem_Roberto_Carlos' },
  { title: 'O Rei Le√£o', time: '4:30', mp3: 'O_Rei_Leao' },
  { title: 'Parab√©ns', time: '3:00', mp3: 'Parabens' },
  { title: 'Preciso Me Encontrar', time: '4:02', mp3: 'Preciso_Me_Encontrar' },
  { title: 'Que Nem Mar√©', time: '3:28', mp3: 'Que_Nem_Mare' },
  { title: 'Sweet Child O Mine', time: '5:05', mp3: 'Sweet_Child_O_Mine' },
  { title: 'The Final Countdown', time: '5:10', mp3: 'The_Final_Countdown' },
  { title: 'Titanium', time: '4:40', mp3: 'Titanium' },
  { title: 'Trompeta de Espanha', time: '3:08', mp3: 'Trompeta_De_Espanha' },
  { title: 'Vilarejo', time: '3:18', mp3: 'Vilarejo' },
  { title: 'Whisky a Go Go', time: '3:33', mp3: 'Whisky_A_Go_Go' },
];
        // --- FUN√á√ïES DE UTILIDADE GERAL ---
        // index.html (Adicionar no bloco de Fun√ß√µes de Utilidade Geral)

function toggleLoader(show, message = 'Carregando...') {
    const loader = document.getElementById('loading-overlay');
    const loaderMessage = document.getElementById('loader-message');
    
    if (!loader || !loaderMessage) return;

    if (show) {
        loaderMessage.textContent = message;
        loader.classList.remove('hidden');
        // For√ßa o reflow para garantir que a transi√ß√£o de opacidade funcione
        void loader.offsetWidth; 
        loader.classList.add('opacity-100', 'flex');
        document.body.style.overflow = 'hidden'; // Opcional: trava o scroll
    } else {
        loader.classList.remove('opacity-100');
        loader.classList.add('opacity-0');
        setTimeout(() => {
            loader.classList.add('hidden');
            loader.classList.remove('flex');
            document.body.style.overflow = '';
        }, 300); // Tempo igual √† transi√ß√£o CSS
    }
}

        function toggleDarkMode() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                html.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function navigateTo(page) {
            const content = document.getElementById('main-content');
            closeVideoModal();
            stopCurrentAudio();

            if (currentPage === page) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                return;
            }

            content.classList.add('opacity-0');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            setTimeout(() => {
                currentPage = page;
                renderPage();

                content.classList.remove('opacity-0');

                const menu = document.getElementById('mobile-menu');
                if (menu && !menu.classList.contains('hidden')) {
                    document.getElementById('mobile-menu-button').click();
                }
            }, 500);
        }

        function updateActiveMenu() {
            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.remove('nav-link-active');
            });

            const activeLink = document.getElementById(`nav-${currentPage}`);
            if (activeLink) {
                activeLink.classList.add('nav-link-active');
            }

            // Tratamento de links adicionais
            if (currentPage === 'member-registration') {
                const cadastroDesktop = document.getElementById('nav-cadastro-desktop');
                const cadastroMobile = document.getElementById('nav-cadastro-mobile');
                if (cadastroDesktop) cadastroDesktop.classList.add('nav-link-active');
                if (cadastroMobile) cadastroMobile.classList.add('nav-link-active');
            }
            if (currentPage === 'reports') {
                const relatoriosDesktop = document.getElementById('nav-relatorios-desktop');
                const relatoriosMobile = document.getElementById('nav-relatorios-mobile');
                if (relatoriosDesktop) relatoriosDesktop.classList.add('nav-link-active');
                if (relatoriosMobile) relatoriosMobile.classList.add('nav-link-active');
            }

            if (subMenuRJB[currentPage]) {
                const rjbButton = document.getElementById('nav-rjb-dropdown');
                if (rjbButton) rjbButton.classList.add('nav-link-active');
            }
        }

        function stopCurrentAudio() {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                currentAudio = null;
            }
            if (playingButton) {
                playingButton.classList.remove('playing');
                playingButton = null;
            }
        }

        function togglePlay(title, mp3File) {
            const button = event.currentTarget;
            const isPlaying = button.classList.contains('playing');

            if (isPlaying) {
                stopCurrentAudio();
                return;
            }

            stopCurrentAudio();

            currentAudio = new Audio(`/audio/${mp3File}.mp3`);
            currentAudio.load();

            playingButton = button;
            button.classList.add('playing');
            currentAudio.play();

            showMessage(`Tocando: ${title}`);

            currentAudio.onended = () => {
                stopCurrentAudio();
            };

            currentAudio.onerror = () => {
                showMessage(`Erro ao carregar o √°udio de: ${title}. Arquivo /audio/${mp3File}.mp3 n√£o encontrado ou inv√°lido.`, true);
                stopCurrentAudio();
            };
        }
        
        // NOVO: Fun√ß√£o de Play para URLs Externas (R2)
        function togglePlayExternal(title, audioUrl) {
            const button = event.currentTarget;
            const isPlaying = button.classList.contains('playing');

            if (isPlaying) {
                stopCurrentAudio();
                return;
            }

            stopCurrentAudio();

            // CR√çTICO: Usa a URL de √°udio completa que veio como par√¢metro
            currentAudio = new Audio(audioUrl);
            currentAudio.load();

            playingButton = button;
            button.classList.add('playing');
            currentAudio.play();

            showMessage(`Tocando: ${title}`);

            currentAudio.onended = () => {
                stopCurrentAudio();
            };

            currentAudio.onerror = () => {
                showMessage(`Erro ao carregar o √°udio de: ${title}. Arquivo ${audioUrl} n√£o encontrado ou inv√°lido.`, true);
                stopCurrentAudio();
            };
        }

        function openModal(imageUrl) {
            const modal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');

            modalImage.src = imageUrl;
            modal.classList.remove('hidden');
            void modal.offsetWidth;
            modal.classList.add('opacity-100');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('image-modal');
            modal.classList.remove('opacity-100');

            setTimeout(() => {
                modal.classList.add('hidden');
                document.getElementById('modal-image').src = "";
                document.body.style.overflow = '';
            }, 300);
        }

        function openVideoModal(videoId) {
            const modal = document.getElementById('video-modal');
            const iframe = document.getElementById('video-iframe');

            iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;

            modal.classList.remove('hidden');
            void modal.offsetWidth;
            modal.classList.add('opacity-100');
            document.body.style.overflow = 'hidden';
        }

        function closeVideoModal() {
            const modal = document.getElementById('video-modal');
            const iframe = document.getElementById('video-iframe');

            modal.classList.remove('opacity-100');

            setTimeout(() => {
                modal.classList.add('hidden');
                iframe.src = ""; // Importante: Limpa o src para parar o som/v√≠deo
                document.body.style.overflow = '';
            }, 300);
        }

        function showMessage(msg, isError = false) {
            const messageBox = document.getElementById('custom-message-box');
            const messageText = document.getElementById('message-text');
            messageText.textContent = msg;

            messageBox.classList.remove('hidden', 'opacity-0', 'message-error', 'bg-rjb-yellow', 'text-rjb-text');

            if (isError) {
                messageBox.classList.add('message-error');
            } else {
                messageBox.classList.add('bg-rjb-yellow', 'text-rjb-text');
            }

            messageBox.classList.add('opacity-100');
            const displayTime = isError ? 5000 : 2500;
            const hideTime = isError ? 5500 : 3000;

            setTimeout(() => {
                messageBox.classList.remove('opacity-100');
                messageBox.classList.add('opacity-0');
            }, displayTime);

            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, hideTime);
        }
// index.html (Adicionar no bloco de Fun√ß√µes de Utilidade Geral)
function filterPartituras() {
    const input = document.getElementById('search-input');
    // Normalize o termo de busca para min√∫sculas e sem acentos para uma busca robusta
    const filterText = input.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, ""); 
    
    // Seleciona todos os itens em ambas as listas
    const items = document.querySelectorAll('.sheet-item');

    let totalVisible = 0;
    
    items.forEach(item => {
        // Pega o t√≠tulo, que √© o primeiro <p> dentro do item
        const titleElement = item.querySelector('p:first-child');
        if (titleElement) {
            const title = titleElement.textContent.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            
            if (title.includes(filterText)) {
                item.style.display = 'flex'; // Torna o item vis√≠vel
                totalVisible++;
            } else {
                item.style.display = 'none'; // Oculta o item
            }
        }
    });

    // Voc√™ pode adicionar um feedback visual se nenhum item for encontrado
    const noResultsMessage = document.getElementById('no-results-message');
    if (filterText.length > 0 && totalVisible === 0) {
        if (!noResultsMessage) {
            const div = document.createElement('div');
            div.id = 'no-results-message';
            div.innerHTML = '<p class="text-center text-xl text-red-500 mt-8">Nenhuma m√∫sica encontrada com esse nome.</p>';
            document.querySelector('.space-y-6').appendChild(div);
        }
    } else if (noResultsMessage) {
        noResultsMessage.remove();
    }
}
// index.html (Adicionar no bloco de Fun√ß√µes de Utilidade Geral)
function toggleAccordion(accordionId) {
    const header = document.getElementById(accordionId + '-header');
    const content = document.getElementById(accordionId + '-content');

    if (!header || !content) return;

    // Toggle classes no header
    header.classList.toggle('open');
    
    // Toggle classes no conte√∫do (accordion-content)
    content.classList.toggle('open');
}
        // --- FUN√á√ïES DE SUBMISS√ÉO E LOGIN (NOVAS) ---

        async function submitContactForm(event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const message = document.getElementById('message').value;

            const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app';

            showMessage('Enviando mensagem...');

            const formData = {
                to: 'contato.racionaljazzband@gmail.com',
                subject: `Nova Mensagem da RJB de ${name}`,
                senderName: name,
                senderEmail: email,
                body: message
            };

            try {
                const response = await fetch(endpointUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData),
                });

                if (response.ok) {
                    showMessage('Mensagem enviada com sucesso! Entraremos em contato em breve.');
                    document.getElementById('contact-form').reset();
                } else {
                    const errorDetails = await response.text();
                    console.error('Erro no Backend:', response.status, errorDetails);
                    showMessage(`Falha ao enviar. Erro ${response.status}. Verifique o console.`, true);
                }

            } catch (error) {
                console.error('ERRO DE CONEX√ÉO/REDE:', error);
                showMessage('Erro de conex√£o. O endpoint do backend pode estar incorreto ou offline.', true);
            }
        }

        async function submitMemberRegistration(event) {
            event.preventDefault();

            const inviteKey = document.getElementById('reg-invite-key').value;
            const name = document.getElementById('reg-name').value;
            const instrument = document.getElementById('reg-instrument').value;
            const email = document.getElementById('reg-email').value;
            const city = document.getElementById('reg-city').value;
            const state = document.getElementById('reg-state').value;

            const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/register-member';

            showMessage('Enviando inscri√ß√£o...');

            const memberData = {
                inviteKey: inviteKey, name: name, instrument: instrument, email: email, city: city, state: state
            };

            try {
                const response = await fetch(endpointUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(memberData),
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage(result.message || 'Inscri√ß√£o de membro registrada com sucesso!');
                    document.getElementById('member-registration-form').reset();
                } else {
                    console.error('Erro no Backend:', response.status, result.message);
                    showMessage(`Falha na inscri√ß√£o. Erro ${response.status}. Detalhes: ${result.message || 'Erro desconhecido.'}`, true);
                }

            } catch (error) {
                console.error('ERRO DE CONEX√ÉO/REDE:', error);
                showMessage('Erro de conex√£o. O servi√ßo de cadastro de membros pode estar offline.', true);
            }
        }

// index.html (SUBSTITUIR A FUN√á√ÉO handleAdminLogin)
async function handleAdminLogin(event) {
    event.preventDefault();

    const email = document.getElementById('admin-email').value;
    const password = document.getElementById('admin-password').value;
    const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/admin/login';

    toggleLoader(true, 'Verificando credenciais...'); // üëà ATIVA O LOADER

    try {
        const response = await fetch(endpointUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password }),
        });

        const result = await response.json();

        if (response.ok) {
            localStorage.setItem('adminToken', result.token);
            localStorage.setItem('adminRole', result.role);
            toggleLoader(false); // üëà DESATIVA ANTES DE CARREGAR O RELAT√ìRIO
            showMessage('Login bem-sucedido. Carregando relat√≥rios...');
            renderProtectedReportView();
        } else {
            toggleLoader(false); // üëà DESATIVA
            showMessage(result.message || 'E-mail ou senha incorretos.', true);
        }

    } catch (error) {
        console.error('ERRO DE CONEX√ÉO/REDE ao fazer login:', error);
        toggleLoader(false); // üëà DESATIVA
        showMessage('Erro de conex√£o com a API de login.', true);
    }
}
// index.html (SUBSTITUIR A FUN√á√ÉO adminLogout)
function adminLogout() {
    toggleLoader(true, 'Finalizando sess√£o...'); // üëà ATIVA O LOADER

    // 1. A√ß√£o CR√çTICA: Remove os tokens de acesso.
    localStorage.removeItem('adminToken');
    localStorage.removeItem('adminRole'); 
    
    // 2. Espera um breve momento (400ms) para a transi√ß√£o do loader
    setTimeout(() => {
        // 3. CORRE√á√ÉO APLICADA: Navega para a p√°gina Home. 
        navigateTo('home'); 

        // 4. Desativa o loader ap√≥s a navega√ß√£o ter sido iniciada.
        toggleLoader(false);
        
        // 5. Mostra a mensagem.
        showMessage('Voc√™ saiu da √Årea Administrativa.', false);
    }, 400); 
}
        // index.html (Adicionar dentro do bloco <script>, perto das outras fun√ß√µes de fetch/render)

        // ... (Fun√ß√µes de fetchMemberReport, renderReportData, etc.) ...

        // --- FUN√á√ïES DE ARQUIVOS (ANEXOS) ---

// index.html (Aprox. Linha 470)

// --- FUN√á√ïES DE ARQUIVOS (ANEXOS) ---

async function fetchAttachmentsReport(token) {
    const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/attachments/list';
    const attachmentsArea = document.getElementById('attachments-output-area');
    
    // CORRE√á√ÉO CR√çTICA: Se a √°rea de anexos n√£o existe, saia.
    if (!attachmentsArea) {
        console.warn('√Årea de anexos (#attachments-output-area) n√£o encontrada no DOM.');
        return; 
    }

    showMessage('Buscando lista de anexos...');
    attachmentsArea.innerHTML = '';

    try {
        const response = await fetch(endpointUrl, {
            method: 'GET',
            headers: { 'Authorization': `Bearer ${token}` }
        });

        const data = await response.json();

        if (response.ok) {
            renderAttachmentsData(data);
        } else {
            showMessage(data.message || `Erro ${response.status} ao buscar anexos.`, true);
            // Mostrar mensagem de erro dentro da √°rea
            attachmentsArea.innerHTML = `<p class="text-center text-red-500">Erro: ${data.message || 'Falha ao carregar anexos.'}</p>`;
        }

    } catch (error) {
        console.error('ERRO DE CONEX√ÉO/REDE ao buscar anexos:', error);
        showMessage('Erro de conex√£o com a API de anexos.', true);
        attachmentsArea.innerHTML = `<p class="text-center text-red-500">Erro de rede ao conectar com a API de anexos.</p>`;
    }
}

        async function handleFileUpload(event) {
            event.preventDefault();

            const fileInput = document.getElementById('attachment-file');
            const token = localStorage.getItem('adminToken');

            if (!fileInput.files.length) {
                showMessage('Selecione um arquivo para upload.', true);
                return;
            }

            showMessage('Enviando arquivo...', false);

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/attachments/upload';

            try {
                const response = await fetch(endpointUrl, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}` },
                    body: formData
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage(result.message || 'Arquivo enviado com sucesso!');
                    document.getElementById('file-upload-form').reset();
                    fetchAttachmentsReport(token); // Atualiza a lista
                } else {
                    console.error('Erro no Backend:', response.status, result.message);
                    showMessage(result.message || `Falha no upload. Erro ${response.status}.`, true);
                }

            } catch (error) {
                console.error('ERRO DE CONEX√ÉO/REDE ao fazer upload:', error);
                showMessage('Erro de conex√£o com a API de upload.', true);
            }
        }

        async function handleDeleteFile(fileName) {
            if (!confirm(`Tem certeza que deseja EXCLUIR o arquivo '${fileName}'? Esta a√ß√£o √© irrevers√≠vel.`)) {
                return;
            }

            const token = localStorage.getItem('adminToken');
            const endpointUrl = `https://rjb-email-sender-215755766100.europe-west1.run.app/api/attachments/delete/${fileName}`;

            showMessage(`Excluindo ${fileName}...`);

            try {
                const response = await fetch(endpointUrl, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                const result = await response.json();

                if (response.ok) {
                    showMessage(result.message || 'Arquivo exclu√≠do com sucesso!');
                    fetchAttachmentsReport(token); // Atualiza a lista
                } else {
                    console.error('Erro no Backend:', response.status, result.message);
                    showMessage(result.message || `Falha na exclus√£o. Erro ${response.status}.`, true);
                }

            } catch (error) {
                console.error('ERRO DE CONEX√ÉO/REDE ao deletar:', error);
                showMessage('Erro de conex√£o com a API de exclus√£o.', true);
            }
        }

        function renderAttachmentsData(files) {
            const attachmentsArea = document.getElementById('attachments-output-area');

            if (files.length === 0) {
                attachmentsArea.innerHTML = '<p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Nenhum anexo encontrado no Google Cloud Storage.</p>';
                return;
            }

            const formatSize = (bytes) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            };

            const fileListHtml = files.map(file => {
                const date = new Date(file.uploaded).toLocaleDateString('pt-BR');
                const time = new Date(file.uploaded).toLocaleTimeString('pt-BR');

                return `
            <div class="flex flex-col sm:flex-row justify-between items-center p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark/50 hover:bg-rjb-yellow/10 dark:hover:bg-rjb-yellow/5 transition-colors duration-300 border-l-4 border-rjb-yellow/50">
                <div class="flex-grow mb-2 sm:mb-0 sm:mr-4">
                    <p class="font-medium text-rjb-text dark:text-rjb-text-dark break-all">${file.name}</p>
                    <p class="text-sm text-rjb-text/60 dark:text-rjb-text-dark/60">${formatSize(file.size)} &bull; ${date} ${time}</p>
                </div>
                <div class="flex space-x-2">
                    <a href="${file.downloadUrl}" target="_blank" download="${file.name}"
                        class="text-sm bg-rjb-yellow text-rjb-text font-bold py-1 px-3 rounded-md hover:bg-yellow-500 transition flex items-center">
                        Download
                    </a>
                    <button onclick="handleDeleteFile('${file.name.replace(/'/g, "\\'")}')"
                        class="text-sm bg-red-600 text-white font-bold py-1 px-3 rounded-md hover:bg-red-700 transition flex items-center">
                        Excluir
                    </button>
                </div>
            </div>
        `;
            }).join('');

            attachmentsArea.innerHTML = `
        <div class="space-y-3">${fileListHtml}</div>
    `;
        }

        function handleDownloadCSV() {
            const token = localStorage.getItem('adminToken');
            const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/reports/members/csv';

            if (!token) {
                showMessage('Erro: Voc√™ n√£o est√° logado.', true);
                return;
            }

            showMessage('Iniciando download do relat√≥rio CSV...');

            fetch(endpointUrl, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(error => { throw new Error(error.message || 'Falha na requisi√ß√£o.'); });
                    }
                    // Cria um link tempor√°rio para for√ßar o download do blob
                    return response.blob();
                })
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'rjb_members_report.csv';
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    window.URL.revokeObjectURL(url);
                    showMessage('Download CSV iniciado com sucesso!');
                })
                .catch(error => {
                    console.error('ERRO AO BAIXAR CSV:', error);
                    showMessage(`Falha ao baixar o arquivo: ${error.message}`, true);
                });
        }

        // index.html (FUN√á√ÉO renderProtectedReportView CORRIGIDA)
        function renderProtectedReportView() {
            const token = localStorage.getItem('adminToken');
            const authArea = document.getElementById('admin-login-area');
            const outputArea = document.getElementById('report-output-area');

            if (!authArea || !outputArea) return;

            if (token) {
                authArea.classList.add('hidden');
                outputArea.classList.remove('hidden');
                // Apenas a chamada de membros, que vai disparar a de anexos AP√ìS o DOM estar pronto.
                fetchMemberReport(token);
            } else {
                authArea.classList.remove('hidden');
                outputArea.classList.add('hidden');
            }
        }

        function renderReportData(data) {
            // 1. A√á√ÉO CR√çTICA: Use a div de detalhes do relat√≥rio de membros (#member-report-details), e n√£o a div pai.
            const reportArea = document.getElementById('member-report-details'); 
            
            // Se a div n√£o existir (nunca deve ocorrer ap√≥s o login), saia.
            if (!reportArea) return; 

            // Conte√∫do de relat√≥rio (Simplificado para evitar quebras, dependente do seu index.js)
            const totalMembros = data.totalMembers || 0;
            const membersListHtml = data.allMembers ? data.allMembers.map(m => `
                <tr class="border-b dark:border-rjb-card-dark hover:bg-rjb-bg-light dark:hover:bg-rjb-card-dark/50 transition-colors">
                    <td class="p-3 font-medium">${m.name}</td>
                    <td class="p-3">${m.instrument}</td>
                    <td class="p-3 hidden sm:table-cell">${m.city}/${m.state}</td>
                </tr>
            `).join('') : '<tr><td colspan="3" class="p-3 text-center">Nenhum membro cadastrado.</td></tr>';

            // 2. PREENCHE APENAS A DIV #member-report-details (mantendo o formul√°rio de anexos e o bot√£o Sair)
            reportArea.innerHTML = `
                <h3 class="text-2xl font-bold text-rjb-yellow mb-4 border-b border-rjb-yellow/50 pb-2">Relat√≥rio de Membros</h3>
                <p class="text-xl font-semibold mb-6">Total de Membros Cadastrados: <span class="text-rjb-yellow">${totalMembros}</span></p>
                
                <button onclick="handleDownloadCSV()" class="bg-rjb-yellow text-rjb-text font-bold py-2 px-6 rounded-lg hover:bg-yellow-500 transition mb-6 shadow-subtle-glow flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    <span>Baixar CSV Completo</span>
                </button>
                
                <h4 class="text-xl font-semibold mt-8 mb-3">Lista Detalhada</h4>
                <div class="overflow-x-auto">
                    <table class="min-w-full text-left bg-rjb-card-light dark:bg-rjb-card-dark rounded-lg shadow-lg">
                        <thead>
                            <tr class="bg-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark/90">
                                <th class="p-3">Nome</th>
                                <th class="p-3">Instrumento</th>
                                <th class="p-3 hidden sm:table-cell">Localidade</th>
                            </tr>
                        </thead>
                        <tbody>${membersListHtml}</tbody>
                    </table>
                </div>
            `;
            
            // Opcional: Garante que a √°rea de anexos est√° limpa antes de carregar (para feedback visual)
            const attachmentsArea = document.getElementById('attachments-output-area');
            if (attachmentsArea) {
                attachmentsArea.innerHTML = '<p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Carregando anexos...</p>';
            }
        }

  // index.html (NOVA VERS√ÉO ROBUSTA DE fetchMemberReport)
async function fetchMemberReport(token) {
    const endpointUrl = 'https://rjb-email-sender-215755766100.europe-west1.run.app/api/reports/members';
    
    // A√á√ÉO CR√çTICA: Mostrar que est√° carregando, mas n√£o limpar a estrutura.
    const reportArea = document.getElementById('member-report-details');
    if (reportArea) {
        reportArea.innerHTML = '<p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Buscando dados protegidos...</p>';
    } else {
        return; // Falha na busca da div, evita o resto
    }

    try {
        const response = await fetch(endpointUrl, {
            method: 'GET',
            headers: { 'Authorization': `Bearer ${token}` }
        });

        const data = await response.json();

        if (response.ok) {
            showMessage('Relat√≥rio carregado com sucesso!');
            renderReportData(data); // Preenche a se√ß√£o de membros.
            
            // CORRE√á√ÉO CR√çTICA DO TIMING: N√£o h√° mais o setTimeout, o DOM j√° deve estar pronto.
            fetchAttachmentsReport(token);

        } else if (response.status === 401 || response.status === 403) {
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminRole');
            showMessage(data.message || 'Sess√£o expirada. Fa√ßa login novamente.', true);
            renderProtectedReportView();
        } else {
            showMessage(data.message || `Erro ${response.status} ao buscar o relat√≥rio.`, true);
            reportArea.innerHTML = `<p class="text-center text-red-500">Erro: ${data.message || 'Falha ao carregar relat√≥rio de membros.'}</p>`;
        }

    } catch (error) {
        console.error('ERRO DE CONEX√ÉO/REDE ao buscar relat√≥rio:', error);
        showMessage('Erro de conex√£o com a API de relat√≥rios.', true);
        reportArea.innerHTML = `<p class="text-center text-red-500">Erro de rede. Verifique o servi√ßo de relat√≥rios.</p>`;
    }
}

// index.html (FUN√á√ÉO renderProtectedReportView CORRIGIDA PARA GARANTIR ESTRUTURA)
function renderProtectedReportView() {
    const token = localStorage.getItem('adminToken');
    const authArea = document.getElementById('admin-login-area');
    const outputArea = document.getElementById('report-output-area');

    if (!authArea || !outputArea) return;

    if (token) {
        authArea.classList.add('hidden');
        outputArea.classList.remove('hidden');
        // A√ß√£o: Inicia a busca dos relat√≥rios de Membros (que dispara a busca de Anexos)
        fetchMemberReport(token); 
    } else {
        authArea.classList.remove('hidden');
        outputArea.classList.add('hidden');
        // Oculta a √°rea de membros se n√£o estiver logado
        document.getElementById('member-report-details').innerHTML = '<p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Carregando relat√≥rio de membros...</p>';
    }
}

// index.html (SUBSTITUIR A FUN√á√ÉO COMPLETA POR ESTA)
function renderReportData(data) {
    // 1. A√á√ÉO CR√çTICA: Use a div de detalhes do relat√≥rio de membros (#member-report-details), e n√£o a div pai.
    const reportArea = document.getElementById('member-report-details'); 
    
    // Se a div n√£o existir (nunca deve ocorrer ap√≥s o login), saia.
    if (!reportArea) return; 

    // Conte√∫do de relat√≥rio (Simplificado para evitar quebras, dependente do seu index.js)
    const totalMembros = data.totalMembers || 0;
    const membersListHtml = data.allMembers ? data.allMembers.map(m => `
        <tr class="border-b dark:border-rjb-card-dark hover:bg-rjb-bg-light dark:hover:bg-rjb-card-dark/50 transition-colors">
            <td class="p-3 font-medium">${m.name}</td>
            <td class="p-3">${m.instrument}</td>
            <td class="p-3 hidden sm:table-cell">${m.city}/${m.state}</td>
        </tr>
    `).join('') : '<tr><td colspan="3" class="p-3 text-center">Nenhum membro cadastrado.</td></tr>';

    // 2. PREENCHE APENAS A DIV #member-report-details (mantendo o formul√°rio de anexos e o bot√£o Sair)
    reportArea.innerHTML = `
        <h3 class="text-2xl font-bold text-rjb-yellow mb-4 border-b border-rjb-yellow/50 pb-2">Relat√≥rio de Membros</h3>
        <p class="text-xl font-semibold mb-6">Total de Membros Cadastrados: <span class="text-rjb-yellow">${totalMembros}</span></p>
        
        <button onclick="handleDownloadCSV()" class="bg-rjb-yellow text-rjb-text font-bold py-2 px-6 rounded-lg hover:bg-yellow-500 transition mb-6 shadow-subtle-glow flex items-center space-x-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
            <span>Baixar CSV Completo</span>
        </button>
        
        <h4 class="text-xl font-semibold mt-8 mb-3">Lista Detalhada</h4>
        <div class="overflow-x-auto">
            <table class="min-w-full text-left bg-rjb-card-light dark:bg-rjb-card-dark rounded-lg shadow-lg">
                <thead>
                    <tr class="bg-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark/90">
                        <th class="p-3">Nome</th>
                        <th class="p-3">Instrumento</th>
                        <th class="p-3 hidden sm:table-cell">Localidade</th>
                    </tr>
                </thead>
                <tbody>${membersListHtml}</tbody>
            </table>
        </div>
    `;
    
    // Opcional: Garante que a √°rea de anexos est√° limpa antes de carregar (para feedback visual)
    const attachmentsArea = document.getElementById('attachments-output-area');
    if (attachmentsArea) {
        attachmentsArea.innerHTML = '<p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Carregando anexos...</p>';
    }
}

        // FUN√á√ÉO DE FALLBACK ROBUSTO PARA MINIATURAS (MANTIDO)
        function handleVideoFallback(img, videoId) {
            let fallbackLevel = parseInt(img.getAttribute('data-fallback-level')) || 0;
            const urls = [
                `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`,
                `https://img.youtube.com/vi/${videoId}/mqdefault.jpg`,
                `https://img.youtube.com/vi/${videoId}/default.jpg`
            ];

            if (fallbackLevel < urls.length) {
                img.setAttribute('data-fallback-level', fallbackLevel + 1);
                img.src = urls[fallbackLevel];
            } else {
                img.onerror = null;
                img.style.backgroundColor = '#1E1E1E';
                img.style.opacity = '0.5';
            }
        }

        function generateVideoCard(video) {
            const thumbnailUrl = `https://img.youtube.com/vi/${video.id}/maxresdefault.jpg`;
            return `
        <div class="group relative rounded-xl overflow-hidden shadow-lg transition-all duration-500 hover:shadow-soft-glow hover:scale-[1.02] border border-rjb-yellow/10 bg-gray-50 dark:bg-rjb-card-dark/50">
            <div class="video-thumbnail-container" onclick="openVideoModal('${video.id}')">
                <img src="${thumbnailUrl}" alt="${video.title}" class="video-thumbnail-img" data-fallback-level="0" onerror="handleVideoFallback(this, '${video.id}')">
                <div class="play-icon-overlay"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z" fill="white"></path></svg></div>
            </div>
            <div class="p-4">
                <h3 class="text-lg font-bold text-rjb-text dark:text-rjb-text-dark leading-tight mb-1">${video.title}</h3>
                <p class="text-rjb-yellow text-sm font-mono">${video.date}</p>
            </div>
        </div>
    `;
        }

        // --- FUN√á√ïES DE GERA√á√ÉO DE CONTE√öDO ---

        function generateHomePageWrapper() { /* (MANTIDO) */ return `
    <section id="home-background-section" class="relative">
        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            ${generateHomePage()}
        </div>
    </section>
    <section class="bg-rjb-bg-light dark:bg-rjb-bg-dark max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20 mt-[-5rem] relative z-20">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div class="p-6 rounded-xl bg-rjb-card-light dark:bg-rjb-card-dark shadow-deep-shadow dark:shadow-xl dark:shadow-black/50 border-t-4 border-rjb-yellow/70 transition-all duration-300 hover:shadow-soft-glow dark:hover:shadow-soft-glow">
                <svg class="w-10 h-10 mx-auto mb-3 text-rjb-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 6h.01M21 3h.01"></path></svg>
                <h3 class="text-xl font-semibold mb-2 text-rjb-text dark:text-rjb-text-dark">M√∫sica Instrumental</h3>
                <p class="text-rjb-text/70 dark:text-rjb-text-dark/70">A harmonia perfeita entre os instrumentos e o saber.</p>
            </div>
            <div class="p-6 rounded-xl bg-rjb-card-light dark:bg-rjb-card-dark shadow-deep-shadow dark:shadow-xl dark:shadow-black/50 border-t-4 border-rjb-yellow/70 transition-all duration-300 hover:shadow-soft-glow dark:hover:shadow-soft-glow">
                <svg class="w-10 h-10 mx-auto mb-3 text-rjb-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7v8l4-2 4 2V7m0 8a2 2 0 11-4 0 2 2 0 014 0zM12 11c0 1.657-1.343 3-3 3H5a2 2 0 01-2-2v-3a2 2 0 012-2h4a2 2 0 012 2v1zM21 17a2 2 0 01-2 2h-5m-7-2a2 2 0 01-2-2V7a2 2 0 012-2h5a2 2 0 012 2v5"></path></svg>
                <h3 class="text-xl font-semibold mb-2 text-rjb-text dark:text-rjb-text-dark">Repert√≥rio √önico</h3>
                <p class="text-rjb-text/70 dark:text-rjb-text-dark/70">Composi√ß√µes pr√≥prias e arranjos exclusivos da cultura Racional.</p>
            </div>
            <div class="p-6 rounded-xl bg-rjb-card-light dark:bg-rjb-card-dark shadow-deep-shadow dark:shadow-xl dark:shadow-black/50 border-t-4 border-rjb-yellow/70 transition-all duration-300 hover:shadow-soft-glow dark:hover:shadow-soft-glow">
                <svg class="w-10 h-10 mx-auto mb-3 text-rjb-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <h3 class="text-xl font-semibold mb-2 text-rjb-text dark:text-rjb-text-dark">Compromisso Cultural</h3>
                <p class="text-rjb-text/70 dark:text-rjb-text-dark/70">Divulgando a Cultura Racional em eventos e apresenta√ß√µes.</p>
            </div>
        </div>
    </section>
`;
        }

        function generateHomePage() { /* (MANTIDO) */ return `
    <div class="text-center pt-12 pb-24">
        <h1 class="text-7xl md:text-9xl font-mono rjb-logo-text text-rjb-yellow mb-2">Racional Jazz Band</h1>
        <h2 class="text-3xl md:text-5xl font-extrabold text-rjb-text dark:text-rjb-text-dark mb-6 transition-colors duration-500">M√∫sica, Arte e Cultura Racional</h2>
        <p class="text-lg md:text-xl text-rjb-text/80 dark:text-rjb-text-dark/80 mb-10 max-w-4xl mx-auto transition-colors duration-500">
            A Racional Jazz Band √© a express√£o musical do conhecimento Racional, unindo a for√ßa do jazz, a beleza da melodia e a pureza de um saber que transcende.
        </p>
        <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
            <button onclick="navigateTo('apresentacoes')" class="bg-rjb-yellow text-rjb-text font-bold py-3 px-8 rounded-full text-lg hover:bg-yellow-500 transition duration-300 transform hover:scale-105 shadow-subtle-glow hover:shadow-soft-glow">
                Ver Apresenta√ß√µes
            </button>
            <button onclick="navigateTo('sobre')" class="bg-transparent border-2 border-rjb-yellow text-rjb-text dark:text-rjb-text-dark font-bold py-3 px-8 rounded-full text-lg hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 transition duration-300 transform hover:scale-105">
                Conhe√ßa a Hist√≥ria
            </button>
        </div>
    </div>
`;
        }

  // index.html (SUBSTITUIR A FUN√á√ÉO generateSobrePage())

function generateSobrePage() {
    return `
        <div class="space-y-8 text-rjb-text dark:text-rjb-text-dark transition-colors duration-500">
            
            <h2 class="text-4xl font-extrabold text-rjb-yellow border-b-2 border-rjb-yellow/50 pb-3">
                A Express√£o Musical do Saber
            </h2>

            <div class="border-l-4 border-rjb-yellow pl-5 bg-rjb-bg-light/50 dark:bg-rjb-card-dark/50 p-4 rounded-lg shadow-sm">
                <p class="text-lg font-medium italic text-rjb-text/90 dark:text-rjb-text-dark/90">
                    A <strong>Racional Jazz Band (RJB)</strong> nasceu da uni√£o de dois prop√≥sitos elevados: a excel√™ncia art√≠stica do Jazz e a profundidade da <strong>Cultura Racional</strong>. Fundada em <strong>20 de novembro de 2015</strong>, a RJB rapidamente se estabeleceu como um ve√≠culo de express√£o para um conhecimento que transcende, utilizando a m√∫sica como sua linguagem universal.
                </p>
            </div>

            <p class="text-rjb-text/80 dark:text-rjb-text-dark/80">
                Acreditamos que a m√∫sica instrumental √© a forma mais pura de comunica√ß√£o. O Jazz, com sua liberdade r√≠tmica e improvisa√ß√£o harmoniosa, oferece o palco ideal para manifestar os sentimentos de equil√≠brio, paz e racioc√≠nio que a Cultura Racional propaga. Cada apresenta√ß√£o √© um convite √† reflex√£o e √† harmonia.
            </p>
            
            <h3 class="text-3xl font-bold text-rjb-text dark:text-rjb-text-dark mt-8 pt-4 border-t border-rjb-text/10 dark:border-rjb-text-dark/10">
                O Conceito Racional
            </h3>

            <p class="text-rjb-text/80 dark:text-rjb-text-dark/80">
                A Cultura Racional √© o conhecimento que revela a origem e o destino de tudo e de todos, promovendo o racioc√≠nio, o equil√≠brio e a liga√ß√£o com o Mundo de Energia Racional. Nossa miss√£o n√£o √© apenas performar; √© <strong>transmitir essa mensagem de Luz e de Paz</strong> atrav√©s de arranjos exclusivos e composi√ß√µes inspiradas nos pilares da Cultura.
            </p>
            
            <p class="text-rjb-text/80 dark:text-rjb-text-dark/80">
                Cada apresenta√ß√£o, cada nota e cada melodia da RJB √© um convite para o p√∫blico refletir sobre sua ess√™ncia e o universo que o cerca, encontrando a harmonia entre o macrocosmo e o pr√≥prio ser.
            </p>

            <div class="mt-12 p-6 bg-rjb-yellow/10 dark:bg-rjb-yellow/5 rounded-xl border border-rjb-yellow/30 shadow-md transition-colors duration-500">
                <h3 class="text-2xl font-bold text-rjb-text dark:text-rjb-text-dark mb-4 flex items-center space-x-2">
                    <svg class="w-6 h-6 text-rjb-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>Nossa Miss√£o</span>
                </h3>
                <ul class="list-disc list-inside space-y-2 text-rjb-text/80 dark:text-rjb-text-dark/80 ml-4">
                    <li>Promover a Cultura Racional atrav√©s da arte musical.</li>
                    <li>Desenvolver e executar um repert√≥rio instrumental de excel√™ncia.</li>
                    <li>Inspirar o racioc√≠nio, o equil√≠brio e a paz no p√∫blico.</li>
                </ul>
            </div>
            
        </div>
    `;
}
        function generateApresentacoesPage() { /* (MANTIDO) */ return `
				<div class="text-rjb-text/80 dark:text-rjb-text-dark/80 mb-8">
					<p>Assista aos nossos principais shows e apresenta√ß√µes de grande p√∫blico. Experi√™ncias sonoras e visuais completas da Racional Jazz Band.</p>
				</div>
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
					${APRESENTACOES_VIDEOS.map(generateVideoCard).join('')}
				</div>
				<p class="text-center mt-12 text-rjb-text/70 dark:text-rjb-text-dark/70">
					Assista a mais performances no nosso canal oficial do YouTube.
				</p>
			`;
        }

        function generateBastidoresPage() { /* (MANTIDO) */ return `
				<div class="text-rjb-text/80 dark:text-rjb-text-dark/80 mb-8">
					<p>Acompanhe o processo criativo, os ensaios e a dedica√ß√£o dos m√∫sicos da Racional Jazz Band. Veja a m√∫sica sendo feita, nota por nota, em v√≠deos exclusivos dos bastidores e entrevistas com a equipe.</p>
				</div>
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
					${BASTIDORES_VIDEOS.map(generateVideoCard).join('')}
				</div>
				<p class="text-center mt-12 text-rjb-text/70 dark:text-rjb-text-dark/70">
					Assista a mais v√≠deos de bastidores e entrevistas no nosso canal oficial do YouTube.
				</p>
			`;
        }

// index.html (SUBSTITUIR A FUN√á√ÉO generateRepertorioPage COMPLETA)
function generateRepertorioPage() {
    
    // Fun√ß√£o interna para renderizar listas
    const renderList = (title, songs, isRacional) => {
        
        // CORRE√á√ÉO CR√çTICA: Define a pasta base (racionais ou diversas) e a subpasta (mp3original)
        const BASE_FOLDER = isRacional ? 'racionais' : 'diversas';
        const FULL_FOLDER_PATH = `${BASE_FOLDER}/mp3original`;
        
        return `
            <div class="mb-10">
                <h3 class="text-3xl font-extrabold mb-6 ${isRacional ? 'text-rjb-yellow' : 'text-rjb-text/90 dark:text-rjb-text-dark/90'} border-b-2 ${isRacional ? 'border-rjb-yellow' : 'border-rjb-text/20 dark:border-rjb-text-dark/20'} pb-2 transition-colors duration-500">
                    ${title}
                </h3>
                <ul class="space-y-3">
                    ${songs.map((song) => {
                        // 1. Constr√≥i o URL de √°udio correto usando o caminho completo din√¢mico
                        const audioUrl = `${R2_BASE_URL}/${FULL_FOLDER_PATH}/${song.mp3}.mp3`;

                        return `
                        <li class="flex justify-between items-center p-4 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark/50 hover:bg-rjb-yellow/10 dark:hover:bg-rjb-yellow/5 transition-colors duration-300 shadow-sm border-l-4 ${isRacional ? 'border-rjb-yellow' : 'border-rjb-text/30 dark:border-rjb-text-dark/30'}">
                            <div class="flex items-center space-x-3">
                                <button onclick="togglePlayExternal('${song.title.trim().replace(/'/g, "\\'")}', '${audioUrl}')" class="play-button text-rjb-yellow hover:text-yellow-600 transition-colors transform hover:scale-105 p-2 rounded-full bg-rjb-yellow/10 hover:bg-rjb-yellow/20 dark:bg-rjb-yellow/5 dark:hover:bg-rjb-yellow/10" data-title="${song.title.trim()}" aria-label="Tocar ${song.title.trim()}">
                                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>
                                </button>
                                <span class="text-lg font-medium text-rjb-text dark:text-rjb-text-dark">${song.title}</span>
                            </div>
                            <span class="text-sm ${isRacional ? 'text-rjb-yellow' : 'text-rjb-text/70 dark:text-rjb-text-dark/70'}">${song.time}</span>
                        </li>
                    `;
                    }).join('')}
                </ul>
            </div>
        `;
    };

    // Retorno final da p√°gina
    return `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
            ${renderList('M√∫sicas Racionais üéß', racionais, true)}
            ${renderList('Outros Cl√°ssicos üé∑', diversas, false)}
        </div>
        <p class="text-center mt-12 text-rjb-text/70 dark:text-rjb-text-dark/70 italic">
            Nosso repert√≥rio est√° em constante expans√£o e renova√ß√£o.
        </p>
    `;
}
// index.html (FUN√á√ÉO generatePartiturasPage - VERS√ÉO CORRIGIDA PARA R2)
function generatePartiturasPage() {
    // 1. Combine e classifique todas as m√∫sicas, ADICIONANDO A PROPRIEDADE 'FOLDER'
    const allSheets = [
        ...racionais.map(s => ({ ...s, category: 'M√∫sica Racional', folder: 'racionais' })),
        ...diversas.map(s => ({ ...s, category: 'Outros Cl√°ssicos', folder: 'diversas' })),
    ].sort((a, b) => a.title.localeCompare(b.title));

    // 2. Agrupe por categoria para renderiza√ß√£o em blocos
    const sheetsByCategory = allSheets.reduce((acc, sheet) => {
        (acc[sheet.category] = acc[sheet.category] || []).push(sheet);
        return acc;
    }, {});

    // 3. Fun√ß√£o de renderiza√ß√£o para cada lista
    const renderSheetList = (categoryTitle, sheets) => {
        if (!sheets || sheets.length === 0) return '';

        const isRacional = sheets[0].folder === 'racionais'; 
        const titleClass = isRacional ? 'text-rjb-yellow' : 'text-rjb-text dark:text-rjb-text-dark';
        const borderColor = isRacional ? 'border-rjb-yellow' : 'border-rjb-text/20 dark:border-rjb-text-dark/20';
        const containerId = isRacional ? 'racionais-list' : 'diversas-list'; 
        const accordionId = isRacional ? 'accordion-racionais' : 'accordion-diversas';
        
        // For√ßa o accordion a abrir para AMBAS as listas
        const isDefaultOpen = true; 

        return `
            <div class="mb-6">
                
                <button id="${accordionId}-header" onclick="toggleAccordion('${accordionId}')" 
                        class="accordion-header flex justify-between items-center w-full p-4 rounded-lg font-extrabold text-xl md:text-2xl 
                               ${isDefaultOpen ? 'open' : ''} ${titleClass} bg-rjb-bg-light dark:bg-rjb-card-dark/50 
                               hover:bg-rjb-yellow/10 dark:hover:bg-rjb-yellow/5 border-l-4 ${borderColor} transition-colors duration-300 shadow-sm">
                    ${categoryTitle} (${sheets.length})
                    <svg class="accordion-header-icon w-6 h-6 transform ${isDefaultOpen ? 'rotate-180' : 'rotate-0'}" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>

                <div id="${accordionId}-content" class="accordion-content ${isDefaultOpen ? 'open' : ''} mt-4">
                    <div id="${containerId}" class="space-y-4">
                        ${sheets.map((sheet) => `
                            <div class="sheet-item p-4 rounded-xl bg-rjb-bg-light dark:bg-rjb-bg-dark/50 flex flex-col md:flex-row justify-between items-center shadow-sm border-l-4 ${isRacional ? 'border-rjb-yellow' : 'border-rjb-text/30 dark:border-rjb-text-dark/30'}">
                                
                                <div class="mb-3 md:mb-0 md:w-1/3">
                                    <p class="text-lg font-medium text-rjb-text dark:text-rjb-text-dark">${sheet.title}</p>
                                    <p class="text-sm text-rjb-text/60 dark:text-rjb-text-dark/60">${sheet.time} &bull; Refer√™ncia / Arquivos</p>
                                </div>

                                <div class="md:w-2/3 flex flex-wrap justify-end space-x-2 space-y-2 md:space-y-0 items-center">
                                    
                                    <div class="flex items-center space-x-2 bg-rjb-yellow/10 py-1 px-2 rounded-lg text-sm">
                                        <audio controls class="rjb-audio-player w-48 h-10 md:w-56" preload="none">
                                            <source src="${R2_BASE_URL}/${sheet.folder}/mp3/${sheet.mp3}.mp3" type="audio/mp3">
                                            Seu navegador n√£o suporta o elemento de √°udio.
                                        </audio>
                                    </div>
                                    
                                    <a href="${R2_BASE_URL}/${sheet.folder}/pdf/${sheet.mp3}.pdf" download="${sheet.title.replace(/ /g, '_')}.pdf"
                                        class="flex items-center space-x-2 bg-rjb-yellow text-rjb-text font-semibold py-2 px-3 rounded-lg hover:bg-yellow-500 transition-colors text-sm transform hover:scale-[1.03] shadow-subtle-glow">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                                        <span>PDF</span>
                                    </a>
                                    
                                    <a href="${R2_BASE_URL}/${sheet.folder}/sib/${sheet.mp3}.sib" download="${sheet.title.replace(/ /g, '_')}.sib"
                                        class="flex items-center space-x-2 bg-rjb-text dark:bg-rjb-card-dark text-white dark:text-rjb-text-dark font-semibold py-2 px-3 rounded-lg hover:bg-gray-700 dark:hover:bg-rjb-bg-dark transition-colors text-sm transform hover:scale-[1.03] border border-transparent dark:border-rjb-text-dark/20">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                        <span>SIB</span>
                                    </a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    };


    // 4. Retorno final da p√°gina (Layout em duas colunas)
    return `
        <div class="space-y-6">
            <p class="text-rjb-text/80 dark:text-rjb-text-dark/80 text-lg mb-8">
                √Årea exclusiva para m√∫sicos. Fa√ßa o download de partituras e refer√™ncias de √°udio para ensaio.
            </p>

            <div class="mb-10">
                <input type="text" id="search-input" onkeyup="filterPartituras()" placeholder="üîé Digite o nome da m√∫sica para buscar..." 
                       class="w-full p-4 rounded-lg bg-rjb-card-light dark:bg-rjb-card-dark border-2 border-rjb-yellow/50 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all shadow-md placeholder-rjb-text/50 dark:placeholder-rjb-text-dark/50">
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                ${renderSheetList('M√∫sicas Racionais', sheetsByCategory['M√∫sica Racional'] || [])}
                ${renderSheetList('Outros Cl√°ssicos', sheetsByCategory['Outros Cl√°ssicos'] || [])}
            </div>
        </div>
    `;
}
        function generateFotosPage() {
            // MOCK de dados internos para esta p√°gina
            const photos = [
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019431831505841433.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534258.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534262.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534265.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534263.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534264.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534261.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534260.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534259.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019629915397534257.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019431831505841431.jpg',
                'https://pub-d3a0bbd0657549f8bdee48c70041537b.r2.dev/images/5019431831505841432.jpg',
            ];

            return `
        <div class="space-y-6">
            <p class="text-lg">
                Uma galeria de momentos capturados em nossos shows, ensaios e eventos.
            </p>
            <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 bg-rjb-bg-light dark:bg-rjb-bg-dark p-4 rounded-xl border border-rjb-yellow/10 transition-colors duration-500">
                ${photos.map((url, index) => `
                    <div onclick="openModal('${url}')" class="group relative overflow-hidden rounded-lg shadow-md aspect-square transition-shadow duration-500 hover:shadow-soft-glow cursor-pointer">
                        <img src="${url}" alt="Foto da Apresenta√ß√£o ${index + 1}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110 group-hover:rotate-1">
                        <div class="absolute inset-0 bg-rjb-yellow/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center cursor-pointer">
                            <span class="text-rjb-text dark:text-rjb-text-dark text-3xl opacity-0 group-hover:opacity-100 transition-opacity delay-200">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                            </span>
                        </div>
                    </div>
                `).join('')}
            </div>
            <p class="pt-4 text-sm italic text-rjb-text/60 dark:text-rjb-text-dark/60">
                Essa turma √© linda n√£o √©? :)
            </p>
        </div>
    `;
        }

        function generateAgendaPage() {
            // MOCK de dados internos para esta p√°gina
            const events = [
                { date: '2025-12-30', time: '20:00', title: 'Dia do S√°bio', location: 'Retiro Racional - Nova Igua√ßu (RJ)', link: '#', dateString: '30 DEZ 2025' },
                //{ date: '2026-01-20', time: '19:30', title: 'Pocket Show - Jazz na Pra√ßa', location: 'Pra√ßa Tiradentes, Curitiba (PR)', link: '#', dateString: '20 JAN 2026' },
                //{ date: '2026-03-05', time: '21:00', title: 'Festival de Jazz de Inverno', location: 'Teatro Pedro II, Ribeir√£o Preto (SP)', link: '#', dateString: '05 MAR 2026' },
            ];

            return `
        <div class="space-y-6">
            <p class="text-lg text-rjb-text/80 dark:text-rjb-text-dark/80 mb-8">
                Confira a nossa agenda de apresenta√ß√µes para participar de momentos inesquec√≠veis de m√∫sica e cultura.
            </p>
            ${events.map(event => `
                <div class="flex flex-col md:flex-row items-start md:items-center p-6 rounded-xl bg-rjb-card-light dark:bg-rjb-card-dark border-l-8 border-rjb-yellow shadow-md hover:shadow-lg transition-all duration-300">
                    <div class="flex-shrink-0 w-full md:w-32 mb-4 md:mb-0 mr-6 text-center">
                        <p class="text-3xl font-extrabold text-rjb-yellow leading-none">${event.dateString.split(' ')[0]}</p>
                        <p class="text-md font-semibold text-rjb-text/90 dark:text-rjb-text-dark/90">${event.dateString.split(' ')[1]} ${event.dateString.split(' ')[2]}</p>
                    </div>
                    <div class="flex-grow">
                        <h3 class="text-2xl font-bold text-rjb-text dark:text-rjb-text-dark mb-1">${event.title}</h3>
                        <p class="text-rjb-text/70 dark:text-rjb-text-dark/70">${event.location} &bull; ${event.time}h</p>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
        }

        function generateContatoPage() { /* (MANTIDO) */ return `
				<div class="max-w-xl mx-auto">
					<p class="text-rjb-text/80 dark:text-rjb-text-dark/80 text-lg mb-8 text-center">
						Para contrata√ß√µes, parcerias ou d√∫vidas gerais, envie-nos uma mensagem.
					</p>
					<form id="contact-form" onsubmit="submitContactForm(event);">
						<div class="space-y-4">
							<div>
								<label for="name" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Nome Completo</label>
								<input type="text" id="name" name="name" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Seu nome">
							</div>
							<div>
								<label for="email" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Email</label>
								<input type="email" id="email" name="email" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="seu.email@exemplo.com">
							</div>
							<div>
								<label for="message" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Mensagem</label>
								<textarea id="message" name="message" rows="4" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Sua mensagem..."></textarea>
							</div>
							<button type="submit" class="w-full bg-rjb-yellow text-rjb-text font-bold py-3 rounded-lg text-lg hover:bg-yellow-500 transition duration-300 transform hover:scale-[1.01] shadow-soft-glow">
								Enviar Mensagem
							</button>
						</div>
					</form>
				</div>
			`;
        }

        function generateCadastroPage() { /* (ATUALIZADO) */ return `
            <div class="max-w-xl mx-auto">
                <p class="text-rjb-text/80 dark:text-rjb-text-dark/80 text-lg mb-8 text-center">
                    Se voc√™ √© m√∫sico, colaborador ou deseja se juntar √† Racional Jazz Band, preencha o formul√°rio abaixo utilizando a <strong>Chave de Convite</strong> fornecida pela equipe.
                </p>
                <form id="member-registration-form" onsubmit="submitMemberRegistration(event);">
                    <div class="space-y-4">
                        <div>
                            <label for="reg-invite-key" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Chave de Convite (Obrigat√≥rio)</label>
                            <input type="text" id="reg-invite-key" name="inviteKey" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Ex: RJB-MEMBER-2025">
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label for="reg-name" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Nome</label>
                                <input type="text" id="reg-name" name="name" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all">
                            </div>
                            <div>
                                <label for="reg-instrument" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Instrumento / √Årea de Colabora√ß√£o</label>
                                <input type="text" id="reg-instrument" name="instrument" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Ex: Saxofone, Design, Log√≠stica">
                            </div>
                        </div>
                        <div>
                            <label for="reg-email" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Email</label>
                            <input type="email" id="reg-email" name="email" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all">
                            </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label for="reg-city" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Cidade</label>
                                <input type="text" id="reg-city" name="city" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Ex: Curitiba">
                            </div>
                            <div>
                                <label for="reg-state" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Estado (UF)</label>
                                <input type="text" id="reg-state" name="state" required class="w-full p-3 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow focus:border-rjb-yellow transition-all" placeholder="Ex: PR">
                            </div>
                        </div>
                        <div class="flex items-center">
                            <input id="terms" type="checkbox" required class="w-4 h-4 text-rjb-yellow bg-rjb-bg-light dark:bg-rjb-bg-dark border-gray-300 rounded focus:ring-rjb-yellow transition-colors duration-300">
                            <label for="terms" class="ml-2 text-sm text-rjb-text/70 dark:text-rjb-text-dark/70">Eu li e concordo com os termos de participa√ß√£o.</label>
                        </div>
                        <button type="submit" class="w-full bg-rjb-yellow text-rjb-text font-bold py-3 rounded-lg text-lg hover:bg-yellow-500 transition duration-300 transform hover:scale-[1.01] shadow-soft-glow">
                            Enviar Inscri√ß√£o
                        </button>
                    </div>
                </form>
            </div>
        `;
        }

        function generateReportsPage() { /* (NOVA P√ÅGINA DE LOGIN) */ return `
            <div class="max-w-4xl mx-auto">
        <h2 class="text-4xl font-extrabold text-rjb-yellow mb-8 text-center">√Årea Administrativa</h2>
        
        <div id="admin-login-area" class="bg-rjb-bg-light dark:bg-rjb-bg-dark/70 p-6 rounded-lg shadow-xl border border-rjb-yellow/20">
            <p class="text-rjb-text/80 dark:text-rjb-text-dark/80 text-lg mb-6 text-center">Acesso restrito para regentes e administradores.</p>
            <form id="admin-login-form" onsubmit="handleAdminLogin(event);">
                <div class="space-y-4">
                    <div>
                        <label for="admin-email" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">E-mail</label>
                        <input type="email" id="admin-email" name="email" required 
                            class="w-full p-3 rounded-lg bg-rjb-card-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow transition-all" 
                            placeholder="Seu e-mail de administrador">
                    </div>
                    <div>
                        <label for="admin-password" class="block text-sm font-medium text-rjb-text/70 dark:text-rjb-text-dark/70 mb-1">Senha</label>
                        <input type="password" id="admin-password" name="password" required 
                            class="w-full p-3 rounded-lg bg-rjb-card-light dark:bg-rjb-bg-dark border border-rjb-yellow/30 text-rjb-text dark:text-rjb-text-dark focus:ring-2 focus:ring-rjb-yellow transition-all" 
                            placeholder="Sua senha secreta">
                    </div>
                    <button type="submit" class="w-full bg-rjb-yellow text-rjb-text font-bold py-3 rounded-lg text-lg hover:bg-yellow-500 transition duration-300 transform hover:scale-[1.01] shadow-soft-glow">
                        Entrar
                    </button>
                </div>
            </form>
        </div>
        
        <div id="report-output-area" class="hidden mt-10 space-y-10">
            
            <div id="member-report-details" class="p-6 bg-rjb-card-light dark:bg-rjb-card-dark rounded-xl shadow-lg border border-rjb-yellow/10">
                <p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Carregando relat√≥rio de membros...</p>
            </div>

            <div class="p-6 bg-rjb-card-light dark:bg-rjb-card-dark rounded-xl shadow-lg border border-rjb-yellow/10">
                <h3 class="text-2xl font-bold text-rjb-yellow mb-4 border-b border-rjb-yellow/50 pb-2">Gerenciamento de Anexos (Arquivos)</h3>
                
                <p class="text-rjb-text/80 dark:text-rjb-text-dark/80 mb-4">Fa√ßa upload de arquivos (PDF, DOCX, XLSX, etc.) e gerencie os anexos dispon√≠veis para o regente.</p>
                
                <form id="file-upload-form" onsubmit="handleFileUpload(event);" class="mb-6 p-4 border border-dashed border-rjb-yellow/50 rounded-lg">
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                        <input type="file" id="attachment-file" name="file" required 
                               class="w-full sm:w-2/3 p-2 border border-rjb-yellow/30 rounded-lg bg-rjb-bg-light dark:bg-rjb-bg-dark text-rjb-text dark:text-rjb-text-dark">
                        <button type="submit" class="w-full sm:w-1/3 bg-rjb-yellow text-rjb-text font-bold py-2 px-4 rounded-lg hover:bg-yellow-500 transition">
                            Upload
                        </button>
                    </div>
                    <p class="text-xs text-rjb-text/50 dark:text-rjb-text-dark/50 mt-2">Tamanho m√°ximo: 5MB.</p>
                </form>

                <h4 class="text-xl font-semibold mt-8 mb-3">Arquivos Atuais no Cloud Storage</h4>
                <div id="attachments-output-area" class="space-y-3">
                    <p class="text-center text-rjb-text/70 dark:text-rjb-text-dark/70">Carregando anexos...</p>
                </div>
            </div>

            <div class="flex justify-end">
                <button onclick="adminLogout()" class="bg-rjb-card-light dark:bg-rjb-card-dark border border-rjb-yellow text-rjb-yellow font-bold py-2 px-6 rounded-lg hover:bg-rjb-yellow/10 transition">
                    Sair da √Årea Administrativa
                </button>
            </div>
        </div>
    </div>
        `;
        }

     // index.html (SUBSTITUIR A FUN√á√ÉO renderPage COMPLETA)
function renderPage() {
    const content = document.getElementById('main-content');
    let html = '';

    let pageTitle = '';

    // 1. Define o t√≠tulo da p√°gina 
    if (subMenuRJB[currentPage]) {
        pageTitle = subMenuRJB[currentPage];
    } else {
        switch (currentPage) {
            case 'home': pageTitle = 'Racional Jazz Band'; break;
            case 'sobre': pageTitle = 'Sobre a RJB'; break;
            case 'agenda': pageTitle = 'Agenda de Eventos'; break;
            case 'contato': pageTitle = 'Fale Conosco'; break;
            case 'member-registration': pageTitle = 'Cadastro de Membros'; break;
            case 'reports': pageTitle = '√Årea Administrativa'; break;
            default: pageTitle = 'P√°gina N√£o Encontrada';
        }
    }

    // 2. Renderiza a Home Page ou o Wrapper de Conte√∫do
    if (currentPage === 'home') {
        html += generateHomePageWrapper();
    } else {
        html += `
            <div class="pt-20 md:pt-28 pb-16 md:pb-24 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <h1 class="text-6xl md:text-8xl font-extrabold rjb-logo-text text-rjb-yellow mb-2 text-center">
                    ${pageTitle.split('/')[0].trim()}
                </h1>
                ${pageTitle.includes('/') ? `<p class="text-xl dark:text-rjb-text-dark/70 text-rjb-text/70 mb-8 text-center">${pageTitle.split('/')[1].trim()}</p>` : ''}
                
                <div class="bg-rjb-card-light dark:bg-rjb-card-dark p-6 md:p-10 rounded-xl shadow-deep-shadow dark:shadow-xl dark:shadow-black/30 z-10 border border-rjb-yellow/10 transition-colors duration-500 text-rjb-text dark:text-rjb-text-dark">
        `;

        // 3. Renderiza o conte√∫do espec√≠fico da p√°gina
        switch (currentPage) {
            case 'sobre': html += generateSobrePage(); break;
            case 'apresentacoes': html += generateApresentacoesPage(); break;
            case 'bastidores': html += generateBastidoresPage(); break;
            case 'repertorio': html += generateRepertorioPage(); break;
            case 'partituras': html += generatePartiturasPage(); break;
            case 'fotos': html += generateFotosPage(); break;
            case 'agenda': html += generateAgendaPage(); break;
            case 'contato': html += generateContatoPage(); break;
            case 'member-registration': html += generateCadastroPage(); break;
            case 'reports': html += generateReportsPage(); break;
            default: html += '<p class="text-center text-xl dark:text-rjb-text-dark/80 text-rjb-text/80">Opa! P√°gina n√£o encontrada.</p>';
        }

        html += `
                </div>
            </div>
        `;
    }
    content.innerHTML = html;

    updateActiveMenu();

    // CHAMA O CONTROLE DE ACESSO SOMENTE NA P√ÅGINA DE RELAT√ìRIOS
    if (currentPage === 'reports') {
        setTimeout(renderProtectedReportView, 0);
    }
}

        // --- Inicializa√ß√£o ---
        document.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            renderPage();

            // L√≥gica de menu m√≥vel (MANTIDA)
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    const openIcon = document.getElementById('menu-open-icon');
                    const closeIcon = document.getElementById('menu-close-icon');
                    if (mobileMenu.classList.contains('hidden')) {
                        openIcon.classList.remove('hidden');
                        closeIcon.classList.add('hidden');
                    } else {
                        openIcon.classList.add('hidden');
                        closeIcon.classList.remove('hidden');
                    }
                });
            }

            // L√≥gica de dropdown (MANTIDA)
            const rjbDropdownButton = document.getElementById('nav-rjb-dropdown');
            const rjbDropdownMenu = document.getElementById('rjb-dropdown-menu');
            if (rjbDropdownButton) {
                rjbDropdownButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    rjbDropdownMenu.classList.toggle('hidden');
                });
            }

            const rjbDropdownButtonMobile = document.getElementById('rjb-dropdown-button-mobile');
            const rjbDropdownMenuMobile = document.getElementById('rjb-dropdown-menu-mobile');
            if (rjbDropdownButtonMobile) {
                rjbDropdownButtonMobile.addEventListener('click', () => {
                    rjbDropdownMenuMobile.classList.toggle('hidden');
                });
            }

            document.addEventListener('click', (e) => {
                if (rjbDropdownMenu && rjbDropdownButton && !rjbDropdownMenu.classList.contains('hidden')) {
                    if (!rjbDropdownButton.contains(e.target) && !rjbDropdownMenu.contains(e.target)) {
                        rjbDropdownMenu.classList.add('hidden');
                    }
                }
            });
        });
    </script>

    <style>
        /* --- Estilos CSS (MANTIDOS) --- */
        body {
            transition: background-color 0.5s ease, color 0.5s ease;
            min-height: 100vh;
        }

        .rjb-logo-text {
            text-shadow: 0 0 4px rgba(255, 215, 0, 0.8);
            letter-spacing: -0.05em;
        }

        #home-background-section {
            background-image: url("WhatsApp Image 2025-11-19 at 17.15.58.jpeg");
            background-size: cover;
            background-position: center 40%;
            background-attachment: fixed;
            position: relative;
            padding-top: 3rem;
            padding-bottom: 10rem;
        }

        #home-background-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.88);
            z-index: 1;
            transition: background-color 0.5s ease;
        }

        .dark #home-background-section::before {
            background-color: rgba(0, 0, 0, 0.7);
        }

        .video-thumbnail-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%;
            overflow: hidden;
            cursor: pointer;
        }

        .video-thumbnail-img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease, opacity 0.3s ease;
        }

        .group:hover .video-thumbnail-img {
            transform: scale(1.05);
        }

        .play-icon-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border: 2px solid #FFD700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        .group:hover .play-icon-overlay {
            background-color: rgba(255, 215, 0, 0.9);
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
        }

        .play-icon-overlay svg {
            width: 30px;
            height: 30px;
            fill: #FFD700;
            margin-left: 4px;
            transition: fill 0.3s ease;
        }

        .group:hover .play-icon-overlay svg {
            fill: #2A2A2A;
        }

        .header-rjb {
            background-color: var(--tw-rjb-card-light);
            border-bottom: 1px solid #EEEEEE;
            transition: background-color 0.5s ease, border-color 0.5s ease;
            z-index: 9999 !important;
        }


        .dark .header-rjb {
            background-color: var(--tw-rjb-card-dark);
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .nav-link-active {
            border-bottom: 2px solid #FFD700;
            padding-bottom: 5px;
        }

        .rjb-logo-image {
            border-radius: 50%;
            border: 2px solid var(--tw-rjb-yellow);
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
            transition: all 0.5s ease;
        }

        .dark .rjb-logo-image {
            border: 2px solid rgba(255, 215, 0, 0.6);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7), 0 0 5px rgba(255, 215, 0, 0.2) inset;
        }

        .play-button.playing svg path {
            d: path("M6 19h4V5H6v14zm8-14v14h4V5h-4z");
            fill-rule: unset;
            clip-rule: unset;
        }

        .message-error {
            background-color: #D32F2F !important;
            color: white !important;
            box-shadow: 0 0 10px rgba(211, 47, 47, 0.7);
        }
        /* --- Estilos CSS Adicionais para o Player de √Åudio --- */
/* Estilo base para a tag audio */
.rjb-audio-player {
    /* Define uma altura consistente e o fundo do player */
    height: 40px; /* Um pouco mais alto que o padr√£o de 32px */
    background-color: var(--tw-rjb-bg-light); /* Fundo claro */
    border-radius: 9999px; /* Arredonda completamente */
    padding: 0 10px;
    border: 1px solid rgba(255, 215, 0, 0.5); /* Borda sutil amarela */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
}

/* Estilos para o modo escuro */
.dark .rjb-audio-player {
    background-color: var(--tw-rjb-card-dark); /* Fundo escuro */
    border: 1px solid rgba(255, 215, 0, 0.2);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
}

/* Estiliza o bot√£o de play/pause (funciona apenas em alguns navegadores, como Chrome) */
.rjb-audio-player::-webkit-media-controls-play-button {
    color: var(--tw-rjb-yellow); 
    background-color: rgba(255, 215, 0, 0.1);
    border-radius: 50%;
    margin-right: 5px;
}

/* Estiliza a barra de progresso (funciona apenas em alguns navegadores, como Chrome) */
.rjb-audio-player::-webkit-media-controls-timeline {
    border-radius: 10px;
    background-color: rgba(255, 215, 0, 0.1);
}

/* Estiliza o ponteiro de progresso (funciona apenas em alguns navegadores, como Chrome) */
.rjb-audio-player::-webkit-media-controls-current-time-display,
.rjb-audio-player::-webkit-media-controls-time-remaining-display {
    color: var(--tw-rjb-text);
}
.dark .rjb-audio-player::-webkit-media-controls-current-time-display,
.dark .rjb-audio-player::-webkit-media-controls-time-remaining-display {
    color: var(--tw-rjb-text-dark);
}
/* --- Estilos CSS para Acorde√£o (Collapse) --- */
.accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Suaviza a anima√ß√£o */
}

.accordion-content.open {
    max-height: 5000px; /* Valor grande o suficiente para a transi√ß√£o */
}

.accordion-header-icon {
    transition: transform 0.3s ease;
}

.accordion-header.open .accordion-header-icon {
    transform: rotate(180deg);
}
    </style>
</head>

<body class="font-sans bg-rjb-bg-light dark:bg-rjb-bg-dark text-rjb-text transition-colors duration-500">

    <header class=" top-0 header-rjb shadow-lg dark:shadow-black/50 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <button onclick="navigateTo('home')"
                    class="hover:opacity-80 transition-opacity flex items-center space-x-2">
                    <img src="logo.jpeg" alt="Racional Jazz Band Logo"
                        class="h-16 w-auto dark:hidden block rjb-logo-image">
                    <img src="logo-dark.png" alt="Racional Jazz Band Logo Dark"
                        class="h-16 w-auto hidden dark:block rjb-logo-image">
                    <span class="sr-only">Racional Jazz Band</span>
                </button>

                <nav class="hidden md:flex space-x-8 items-center">
                    <button id="nav-home" onclick="navigateTo('home')"
                        class="nav-link text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">Home</button>
                    <button id="nav-sobre" onclick="navigateTo('sobre')"
                        class="nav-link text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">Sobre</button>

                    <div class="relative group">
                        <button id="nav-rjb-dropdown"
                            class="nav-link flex items-center text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">
                            A RJB
                            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="rjb-dropdown-menu"
                            class="hidden absolute left-1/2 transform -translate-x-1/2 mt-0 w-48 rounded-md shadow-lg bg-rjb-card-light dark:bg-rjb-card-dark ring-1 ring-rjb-yellow/20 dark:ring-rjb-yellow/50 focus:outline-none z-50 transition-colors duration-500">
                            <div class="py-1">
                                <button id="nav-repertorio" onclick="navigateTo('repertorio')"
                                    class="nav-link block w-full text-left px-4 py-2 text-sm text-rjb-text dark:text-rjb-text-dark hover:bg-rjb-yellow hover:text-rjb-text transition-colors">Repert√≥rio</button>
                                <button id="nav-partituras" onclick="navigateTo('partituras')"
                                    class="nav-link block w-full text-left px-4 py-2 text-sm text-rjb-text dark:text-rjb-text-dark hover:bg-rjb-yellow hover:text-rjb-text transition-colors">√Årea
                                    de Partituras</button>
                                <button id="nav-fotos" onclick="navigateTo('fotos')"
                                    class="nav-link block w-full text-left px-4 py-2 text-sm text-rjb-text dark:text-rjb-text-dark hover:bg-rjb-yellow hover:text-rjb-text transition-colors">Galeria
                                    de Fotos</button>
                                <button id="nav-apresentacoes" onclick="navigateTo('apresentacoes')"
                                    class="nav-link block w-full text-left px-4 py-2 text-sm text-rjb-text dark:text-rjb-text-dark hover:bg-rjb-yellow hover:text-rjb-text transition-colors">Apresenta√ß√µes</button>
                                <button id="nav-bastidores" onclick="navigateTo('bastidores')"
                                    class="nav-link block w-full text-left px-4 py-2 text-sm text-rjb-text dark:text-rjb-text-dark hover:bg-rjb-yellow hover:text-rjb-text transition-colors">Ensaios</button>
                            </div>
                        </div>
                    </div>

                    <button id="nav-agenda" onclick="navigateTo('agenda')"
                        class="nav-link text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">Agenda</button>
                    <button id="nav-contato" onclick="navigateTo('contato')"
                        class="nav-link text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">Contato</button>

                    <button id="nav-relatorios-desktop" onclick="navigateTo('reports')"
                        class="nav-link text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors font-semibold py-5">√Årea
                        Administrativa</button>

                    <button onclick="toggleDarkMode()"
                        class="text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors p-2 rounded-full hover:bg-rjb-yellow/10 focus:outline-none">
                        <svg class="w-6 h-6 dark:block hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z">
                            </path>
                        </svg>
                        <svg class="w-6 h-6 dark:hidden block" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                            </path>
                        </svg>
                    </button>
                </nav>

                <button id="nav-cadastro-desktop" onclick="navigateTo('member-registration')"
                    class="nav-link bg-rjb-yellow text-rjb-text font-bold py-2 px-4 rounded-full text-sm hover:bg-yellow-500 transition-colors shadow-subtle-glow hidden md:block">
                    Cadastro
                </button>

                <div class="md:hidden flex items-center space-x-2">
                    <button onclick="toggleDarkMode()"
                        class="text-rjb-text dark:text-rjb-text-dark hover:text-rjb-yellow transition-colors p-2 rounded-md hover:bg-rjb-yellow/10 focus:outline-none">
                        <svg class="w-6 h-6 dark:block hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z">
                            </path>
                        </svg>
                        <svg class="w-6 h-6 dark:hidden block" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                            </path>
                        </svg>
                    </button>

                    <button id="mobile-menu-button" type="button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-rjb-text/70 dark:text-rjb-text-dark/70 hover:text-rjb-text dark:hover:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-card-dark focus:outline-none focus:ring-2 focus:ring-inset focus:ring-rjb-yellow transition-colors duration-500"
                        aria-controls="mobile-menu" aria-expanded="false">
                        <svg id="menu-open-icon" class="block h-6 w-6" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                        <svg id="menu-close-icon" class="hidden h-6 w-6" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="md:hidden hidden w-full bg-rjb-card-light dark:bg-rjb-card-dark border-b border-rjb-yellow/30 pb-3 transition-colors duration-500 z-40"
            id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button id="nav-home-mobile" onclick="navigateTo('home')"
                    class="nav-link block w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors">Home</button>
                <button id="nav-sobre-mobile" onclick="navigateTo('sobre')"
                    class="nav-link block w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors">Sobre</button>

                <div class="relative nav-item-rjb">
                    <button id="rjb-dropdown-button-mobile"
                        class="flex items-center justify-between w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors"
                        aria-expanded="false">
                        A RJB
                        <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7">
                            </path>
                        </svg>
                    </button>
                    <div id="rjb-dropdown-menu-mobile"
                        class="hidden pl-4 bg-rjb-bg-light dark:bg-rjb-card-dark/70 rounded-md transition-colors duration-500">
                        <button id="nav-apresentacoes-mobile" onclick="navigateTo('apresentacoes')"
                            class="nav-link block w-full text-left px-3 py-2 text-sm text-rjb-text/90 dark:text-rjb-text-dark/90 hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 hover:text-rjb-text transition-colors">Performances
                            Oficiais</button>
                        <button id="nav-bastidores-mobile" onclick="navigateTo('bastidores')"
                            class="nav-link block w-full text-left px-3 py-2 text-sm text-rjb-text/90 dark:text-rjb-text-dark/90 hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 hover:text-rjb-text transition-colors">Bastidores
                            & Ensaios</button>
                        <button id="nav-repertorio-mobile" onclick="navigateTo('repertorio')"
                            class="nav-link block w-full text-left px-3 py-2 text-sm text-rjb-text/90 dark:text-rjb-text-dark/90 hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 hover:text-rjb-text transition-colors">Repert√≥rio</button>
                        <button id="nav-partituras-mobile" onclick="navigateTo('partituras')"
                            class="nav-link block w-full text-left px-3 py-2 text-sm text-rjb-text/90 dark:text-rjb-text-dark/90 hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 hover:text-rjb-text transition-colors">√Årea
                            de Partituras</button>
                        <button id="nav-fotos-mobile" onclick="navigateTo('fotos')"
                            class="nav-link block w-full text-left px-3 py-2 text-sm text-rjb-text/90 dark:text-rjb-text-dark/90 hover:bg-rjb-yellow/20 dark:hover:bg-rjb-yellow/10 hover:text-rjb-text transition-colors">Fotos</button>
                    </div>
                </div>

                <button id="nav-agenda-mobile" onclick="navigateTo('agenda')"
                    class="nav-link block w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors">Agenda</button>
                <button id="nav-contato-mobile" onclick="navigateTo('contato')"
                    class="nav-link block w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors">Contato</button>

                <button id="nav-relatorios-mobile" onclick="navigateTo('reports')"
                    class="nav-link block w-full text-left px-3 py-2 rounded-md text-base font-medium text-rjb-text dark:text-rjb-text-dark hover:bg-gray-100 dark:hover:bg-rjb-bg-dark/10 hover:text-rjb-yellow transition-colors">√Årea
                    Administrativa</button>

                <button id="nav-cadastro-mobile" onclick="navigateTo('member-registration')"
                    class="nav-link block w-full text-left mt-2 bg-rjb-yellow text-rjb-text font-bold py-2 px-3 rounded-md text-base hover:bg-yellow-500 transition-colors shadow-subtle-glow">Cadastro</button>
            </div>
        </div>
    </header>

    <main id="main-content" class="opacity-100 transition-opacity duration-500 pt-20">
</main>

    <footer
        class="bg-rjb-card-light dark:bg-rjb-card-dark border-t border-rjb-yellow/20 mt-12 py-8 z-20 relative transition-colors duration-500">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="rjb-logo-text text-xl font-mono font-extrabold text-rjb-yellow">RJB</div>
            <p class="text-rjb-text/70 dark:text-rjb-text-dark/70 text-sm mt-1 mb-4">Racional Jazz Band &copy; 2025.
                Todos os direitos reservados.</p>
            <div class="space-x-4 text-rjb-text/50 dark:text-rjb-text-dark/50 text-sm">
                <button onclick="navigateTo('sobre')" class="hover:text-rjb-yellow transition-colors">Pol√≠tica de
                    Privacidade</button>
                <span>|</span>
                <button onclick="navigateTo('contato')" class="hover:text-rjb-yellow transition-colors">Termos de
                    Uso</button>
                <span>|</span>
                <button onclick="navigateTo('member-registration')"
                    class="hover:text-rjb-yellow transition-colors">Trabalhe
                    Conosco</button>
            </div>
        </div>
        <div id="audio-player-container" class="hidden"></div>
    </footer>

    <div id="image-modal" onclick="closeModal()"
        class="fixed inset-0 bg-black bg-opacity-90 z-[70] hidden flex items-center justify-center transition-opacity duration-300 opacity-0">
        <div onclick="event.stopPropagation()" class="max-w-7xl max-h-[90vh] mx-auto p-4 relative">
            <button onclick="closeModal()"
                class="absolute top-4 right-4 text-white hover:text-rjb-yellow transition-colors text-4xl font-light z-10 p-2">
                &times;
            </button>
            <img id="modal-image" src="" alt="Imagem Ampliada"
                class="max-h-[85vh] w-auto object-contain rounded-lg shadow-soft-glow">
        </div>
    </div>

    <div id="video-modal" onclick="closeVideoModal()"
        class="fixed inset-0 bg-black bg-opacity-95 z-[80] hidden flex items-center justify-center transition-opacity duration-300 opacity-0">
        <div onclick="event.stopPropagation()" class="w-full max-w-5xl mx-auto p-4 relative">
            <button onclick="closeVideoModal()"
                class="absolute -top-10 right-4 text-white hover:text-rjb-yellow text-4xl font-light z-10 p-2 transition-colors">&times;</button>

            <div
                class="relative w-full pt-[56.25%] bg-black rounded-lg shadow-soft-glow overflow-hidden border border-rjb-yellow/30">
                <iframe id="video-iframe" class="absolute top-0 left-0 w-full h-full" src=""
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>
    <div id="custom-message-box"
        class="hidden opacity-0 fixed top-5 left-1/2 transform -translate-x-1/2 bg-rjb-yellow text-rjb-text px-6 py-3 rounded-lg shadow-deep-shadow dark:shadow-soft-glow z-[60] transition-opacity duration-300">
        <p id="message-text" class="font-semibold"></p>
    </div>
    <div id="loading-overlay"
        class="fixed inset-0 bg-rjb-bg-light/90 dark:bg-rjb-bg-dark/90 z-[100] hidden items-center justify-center transition-opacity duration-300 opacity-0">
        <div class="flex flex-col items-center space-y-4">
            <svg class="animate-spin h-10 w-10 text-rjb-yellow" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
            <p id="loader-message" class="text-lg font-semibold text-rjb-text dark:text-rjb-text-dark">Carregando...</p>
        </div>
    </div>
    
    <div id="custom-message-box"
        class="hidden opacity-0 fixed top-5 left-1/2 transform -translate-x-1/2 bg-rjb-yellow text-rjb-text px-6 py-3 rounded-lg shadow-deep-shadow dark:shadow-soft-glow z-[60] transition-opacity duration-300">
        <p id="message-text" class="font-semibold"></p>
    </div>

</body>

</html>